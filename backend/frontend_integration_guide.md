# üîß Frontend Integration Guide for Enhanced Duplicate Validation\n\n## üìã **Overview**\n\nThis guide shows how to integrate the enhanced duplicate validation system into your frontend registration form.\n\n## üéØ **Available Duplicate Checks**\n\n1. **Email Duplicate** - \"Email is already taken.\"\n2. **Mobile Number Duplicate** - \"Mobile number is already registered.\"\n3. **Password Duplicate** - \"Password is already taken.\"\n4. **Face Duplicate** - \"This face is already registered with another account.\"\n5. **Roll Number Duplicate** - \"Roll number already exists\"\n\n## üîó **API Endpoints**\n\n### Individual Duplicate Checks\n```javascript\n// Check email\nGET /api/students/check-email-duplicate/?email=test@example.com\n\n// Check phone\nGET /api/students/check-phone-duplicate/?phone_number=1234567890\n\n// Check password\nPOST /api/students/check-password-duplicate/\nBody: {\"password\": \"mypassword123\"}\n\n// Check roll number\nGET /api/students/check-roll-number-duplicate/?roll_number=22\n\n// Check face\nPOST /api/students/check-face-duplicate/\nBody: {\"face_image_data\": \"data:image/jpeg;base64,...\"}\n```\n\n### Batch Duplicate Check\n```javascript\nPOST /api/students/check-duplicates/\nBody: {\n    \"email\": \"test@example.com\",\n    \"phone_number\": \"1234567890\",\n    \"password\": \"mypassword123\",\n    \"roll_number\": \"22\",\n    \"face_image_data\": \"data:image/jpeg;base64,...\"\n}\n```\n\n### Enhanced Registration\n```javascript\nPOST /api/students/enhanced-register/\nBody: {\n    \"username\": \"john_doe\",\n    \"email\": \"john@example.com\",\n    \"password\": \"securepassword123\",\n    \"confirm_password\": \"securepassword123\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"roll_number\": \"22\",\n    \"student_class\": \"10A\",\n    \"phone_number\": \"1234567890\",\n    \"address\": \"123 Main St\",\n    \"face_image_data\": \"data:image/jpeg;base64,...\"\n}\n```\n\n## üé® **Frontend Implementation Examples**\n\n### React Implementation\n\n```jsx\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst EnhancedRegistrationForm = () => {\n    const [formData, setFormData] = useState({\n        username: '',\n        email: '',\n        password: '',\n        confirm_password: '',\n        first_name: '',\n        last_name: '',\n        roll_number: '',\n        student_class: '',\n        phone_number: '',\n        address: '',\n        face_image_data: ''\n    });\n    \n    const [errors, setErrors] = useState({});\n    const [duplicateChecks, setDuplicateChecks] = useState({});\n    \n    // Real-time duplicate checking\n    const checkDuplicate = async (field, value) => {\n        if (!value) return;\n        \n        try {\n            let response;\n            \n            switch (field) {\n                case 'email':\n                    response = await axios.get(`/api/students/check-email-duplicate/?email=${value}`);\n                    break;\n                case 'phone_number':\n                    response = await axios.get(`/api/students/check-phone-duplicate/?phone_number=${value}`);\n                    break;\n                case 'password':\n                    response = await axios.post('/api/students/check-password-duplicate/', { password: value });\n                    break;\n                case 'roll_number':\n                    response = await axios.get(`/api/students/check-roll-number-duplicate/?roll_number=${value}`);\n                    break;\n                case 'face_image_data':\n                    response = await axios.post('/api/students/check-face-duplicate/', { face_image_data: value });\n                    break;\n                default:\n                    return;\n            }\n            \n            setDuplicateChecks(prev => ({\n                ...prev,\n                [field]: response.data\n            }));\n            \n            if (response.data.exists) {\n                setErrors(prev => ({\n                    ...prev,\n                    [field]: response.data.message\n                }));\n            } else {\n                setErrors(prev => {\n                    const newErrors = { ...prev };\n                    delete newErrors[field];\n                    return newErrors;\n                });\n            }\n            \n        } catch (error) {\n            console.error(`Error checking ${field} duplicate:`, error);\n        }\n    };\n    \n    // Debounced duplicate checking\n    useEffect(() => {\n        const timer = setTimeout(() => {\n            if (formData.email) checkDuplicate('email', formData.email);\n        }, 500);\n        return () => clearTimeout(timer);\n    }, [formData.email]);\n    \n    useEffect(() => {\n        const timer = setTimeout(() => {\n            if (formData.phone_number) checkDuplicate('phone_number', formData.phone_number);\n        }, 500);\n        return () => clearTimeout(timer);\n    }, [formData.phone_number]);\n    \n    useEffect(() => {\n        const timer = setTimeout(() => {\n            if (formData.password) checkDuplicate('password', formData.password);\n        }, 500);\n        return () => clearTimeout(timer);\n    }, [formData.password]);\n    \n    useEffect(() => {\n        const timer = setTimeout(() => {\n            if (formData.roll_number) checkDuplicate('roll_number', formData.roll_number);\n        }, 500);\n        return () => clearTimeout(timer);\n    }, [formData.roll_number]);\n    \n    const handleInputChange = (e) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: value\n        }));\n    };\n    \n    const handleFaceCapture = (imageData) => {\n        setFormData(prev => ({\n            ...prev,\n            face_image_data: imageData\n        }));\n        \n        // Check face duplicate\n        checkDuplicate('face_image_data', imageData);\n    };\n    \n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        \n        // Check if there are any duplicate errors\n        const hasDuplicates = Object.values(duplicateChecks).some(check => check.exists);\n        if (hasDuplicates) {\n            alert('Please resolve duplicate issues before submitting.');\n            return;\n        }\n        \n        try {\n            const response = await axios.post('/api/students/enhanced-register/', formData);\n            alert('Registration successful!');\n            // Redirect or reset form\n        } catch (error) {\n            if (error.response?.data) {\n                setErrors(error.response.data);\n                \n                // Show specific duplicate error alerts\n                const errorData = error.response.data;\n                if (errorData.email) alert(errorData.email[0]);\n                if (errorData.phone_number) alert(errorData.phone_number[0]);\n                if (errorData.password) alert(errorData.password[0]);\n                if (errorData.face_image_data) alert(errorData.face_image_data[0]);\n            }\n        }\n    };\n    \n    return (\n        <form onSubmit={handleSubmit}>\n            {/* Email Field */}\n            <div className=\"form-group\">\n                <label>Email:</label>\n                <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleInputChange}\n                    className={errors.email ? 'error' : ''}\n                />\n                {errors.email && <span className=\"error-message\">{errors.email}</span>}\n                {duplicateChecks.email?.exists && (\n                    <span className=\"duplicate-warning\">‚ö†Ô∏è Email is already taken.</span>\n                )}\n            </div>\n            \n            {/* Phone Number Field */}\n            <div className=\"form-group\">\n                <label>Phone Number:</label>\n                <input\n                    type=\"tel\"\n                    name=\"phone_number\"\n                    value={formData.phone_number}\n                    onChange={handleInputChange}\n                    className={errors.phone_number ? 'error' : ''}\n                />\n                {errors.phone_number && <span className=\"error-message\">{errors.phone_number}</span>}\n                {duplicateChecks.phone_number?.exists && (\n                    <span className=\"duplicate-warning\">‚ö†Ô∏è Mobile number is already registered.</span>\n                )}\n            </div>\n            \n            {/* Password Field */}\n            <div className=\"form-group\">\n                <label>Password:</label>\n                <input\n                    type=\"password\"\n                    name=\"password\"\n                    value={formData.password}\n                    onChange={handleInputChange}\n                    className={errors.password ? 'error' : ''}\n                />\n                {errors.password && <span className=\"error-message\">{errors.password}</span>}\n                {duplicateChecks.password?.exists && (\n                    <span className=\"duplicate-warning\">‚ö†Ô∏è Password is already taken.</span>\n                )}\n            </div>\n            \n            {/* Roll Number Field */}\n            <div className=\"form-group\">\n                <label>Roll Number:</label>\n                <input\n                    type=\"text\"\n                    name=\"roll_number\"\n                    value={formData.roll_number}\n                    onChange={handleInputChange}\n                    className={errors.roll_number ? 'error' : ''}\n                />\n                {errors.roll_number && <span className=\"error-message\">{errors.roll_number}</span>}\n                {duplicateChecks.roll_number?.exists && (\n                    <span className=\"duplicate-warning\">‚ö†Ô∏è Roll number already exists.</span>\n                )}\n            </div>\n            \n            {/* Face Capture */}\n            <div className=\"form-group\">\n                <label>Face Registration:</label>\n                <WebcamCapture onCapture={handleFaceCapture} />\n                {errors.face_image_data && <span className=\"error-message\">{errors.face_image_data}</span>}\n                {duplicateChecks.face_image_data?.exists && (\n                    <div className=\"duplicate-warning\">\n                        ‚ö†Ô∏è This face is already registered with another account.\n                        {duplicateChecks.face_image_data.duplicate_info && (\n                            <div>\n                                Student: {duplicateChecks.face_image_data.duplicate_info.student_name} \n                                (Roll: {duplicateChecks.face_image_data.duplicate_info.roll_number})\n                            </div>\n                        )}\n                    </div>\n                )}\n            </div>\n            \n            {/* Other form fields... */}\n            \n            <button type=\"submit\" disabled={Object.values(duplicateChecks).some(check => check.exists)}>\n                Register\n            </button>\n        </form>\n    );\n};\n\nexport default EnhancedRegistrationForm;\n```\n\n### Vanilla JavaScript Implementation\n\n```javascript\nclass DuplicateValidator {\n    constructor() {\n        this.debounceTimers = {};\n    }\n    \n    // Debounced duplicate checking\n    checkDuplicate(field, value, callback) {\n        clearTimeout(this.debounceTimers[field]);\n        \n        this.debounceTimers[field] = setTimeout(async () => {\n            if (!value) return;\n            \n            try {\n                let response;\n                \n                switch (field) {\n                    case 'email':\n                        response = await fetch(`/api/students/check-email-duplicate/?email=${encodeURIComponent(value)}`);\n                        break;\n                    case 'phone_number':\n                        response = await fetch(`/api/students/check-phone-duplicate/?phone_number=${encodeURIComponent(value)}`);\n                        break;\n                    case 'password':\n                        response = await fetch('/api/students/check-password-duplicate/', {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ password: value })\n                        });\n                        break;\n                    case 'roll_number':\n                        response = await fetch(`/api/students/check-roll-number-duplicate/?roll_number=${encodeURIComponent(value)}`);\n                        break;\n                    case 'face_image_data':\n                        response = await fetch('/api/students/check-face-duplicate/', {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ face_image_data: value })\n                        });\n                        break;\n                    default:\n                        return;\n                }\n                \n                const data = await response.json();\n                callback(field, data);\n                \n            } catch (error) {\n                console.error(`Error checking ${field} duplicate:`, error);\n            }\n        }, 500);\n    }\n    \n    // Show duplicate warning\n    showDuplicateWarning(field, data) {\n        const fieldElement = document.getElementById(field);\n        const warningElement = document.getElementById(`${field}-warning`);\n        \n        if (data.exists) {\n            fieldElement.classList.add('error');\n            warningElement.textContent = data.message;\n            warningElement.style.display = 'block';\n            \n            // Show alert for immediate feedback\n            alert(data.message);\n        } else {\n            fieldElement.classList.remove('error');\n            warningElement.style.display = 'none';\n        }\n    }\n}\n\n// Usage\nconst validator = new DuplicateValidator();\n\n// Add event listeners\ndocument.getElementById('email').addEventListener('input', (e) => {\n    validator.checkDuplicate('email', e.target.value, validator.showDuplicateWarning);\n});\n\ndocument.getElementById('phone_number').addEventListener('input', (e) => {\n    validator.checkDuplicate('phone_number', e.target.value, validator.showDuplicateWarning);\n});\n\ndocument.getElementById('password').addEventListener('input', (e) => {\n    validator.checkDuplicate('password', e.target.value, validator.showDuplicateWarning);\n});\n\ndocument.getElementById('roll_number').addEventListener('input', (e) => {\n    validator.checkDuplicate('roll_number', e.target.value, validator.showDuplicateWarning);\n});\n```\n\n## üé® **CSS Styles for Duplicate Warnings**\n\n```css\n.form-group {\n    margin-bottom: 1rem;\n}\n\n.error {\n    border: 2px solid #ff4444;\n    background-color: #fff5f5;\n}\n\n.error-message {\n    color: #ff4444;\n    font-size: 0.875rem;\n    display: block;\n    margin-top: 0.25rem;\n}\n\n.duplicate-warning {\n    color: #ff6600;\n    font-size: 0.875rem;\n    display: block;\n    margin-top: 0.25rem;\n    font-weight: bold;\n}\n\n.duplicate-warning::before {\n    content: \"‚ö†Ô∏è \";\n}\n\nbutton:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n```\n\n## üì± **Alert Messages**\n\nThe system will show these specific alert messages:\n\n- **Email Duplicate**: \"Email is already taken.\"\n- **Mobile Duplicate**: \"Mobile number is already registered.\"\n- **Password Duplicate**: \"Password is already taken.\"\n- **Face Duplicate**: \"This face is already registered with another account.\"\n- **Roll Number Duplicate**: \"Roll number already exists\"\n\n## üîß **Error Handling**\n\n```javascript\n// Handle registration errors\ntry {\n    const response = await fetch('/api/students/enhanced-register/', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(formData)\n    });\n    \n    if (!response.ok) {\n        const errorData = await response.json();\n        \n        // Show specific duplicate alerts\n        if (errorData.email) alert(errorData.email[0]);\n        if (errorData.phone_number) alert(errorData.phone_number[0]);\n        if (errorData.password) alert(errorData.password[0]);\n        if (errorData.face_image_data) alert(errorData.face_image_data[0]);\n        if (errorData.roll_number) alert(errorData.roll_number[0]);\n        \n        return;\n    }\n    \n    const result = await response.json();\n    alert('Registration successful!');\n    \n} catch (error) {\n    console.error('Registration error:', error);\n    alert('Registration failed. Please try again.');\n}\n```\n\nThis implementation provides real-time duplicate checking with immediate user feedback through alerts and visual indicators."
  }
]